{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 3da949fad1755390006d","webpack:///./src/composr-connector.js","webpack:///./src/utils/utils.js","webpack:///./src/utils/events.js","webpack:///./src/utils/jwt.js","webpack:///./src/utils/cryptography.js","webpack:///./src/auth/AuthRequest.js","webpack:///./src/auth/AuthPersist.js","webpack:///./src/auth/AuthConnector.js","webpack:///./src/connect/Connect.js"],"names":[],"mappings":"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","file":"composr-connector.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"composrCR\"] = factory();\n\telse\n\t\troot[\"composrCR\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 3da949fad1755390006d\n **/","export * from './utils/utils';\nexport { default as AuthRequest } from './auth/AuthRequest';\nexport { default as AuthPersist } from './auth/AuthPersist';\nexport { default as AuthConnector } from './auth/AuthConnector';\nexport { default as Connect } from './connect/Connect';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/composr-connector.js\n **/","import * as jwt from './jwt';\nexport * from './events';\n\nexport function buildURI(urlBase) {\n  return urlBase.replace('{{module}}', 'composr');\n}\n\nexport function checkStatus(response) {\n  if (response.ok) {\n    return response.json().catch(() => response);\n  }\n\n  let error = new Error(response.statusText);\n  error.status = response.status;\n  error.response = response;\n  throw error;\n\n}\n\nexport function generateUUID() {\n  let d = new Date().getTime();\n  let uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    let r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n  });\n  return uuid;\n}\n\nexport {\n  jwt\n };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/utils.js\n **/","// Based on David Walsh's pub-sub implementation\n// https://davidwalsh.name/pubsub-javascript\n\nlet topics = {};\nlet hOP = topics.hasOwnProperty;\n\nexport const events = {\n  subscribe: function(topic, listener) {\n    // Create the topic's object if not yet created\n    if (!hOP.call(topics, topic)) {\n      topics[topic] = [];\n    }\n\n    // Add the listener to queue\n    let index = topics[topic].push(listener) - 1;\n\n    // Provide handle back for removal of topic\n    return {\n      remove: function() {\n        delete topics[topic][index];\n      }\n    };\n  },\n  publish: function(topic, info) {\n    // If the topic doesn't exist, or there's no listeners in queue, just leave\n    if (!hOP.call(topics, topic)) {\n      return;\n    }\n\n    // Cycle through topics queue, fire!\n    topics[topic].forEach(function(item) {\n      item(info != undefined ? info : {});\n    });\n  }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/events.js\n **/","import * as cryptography from './cryptography';\n\n/*\n * Extracted from Corbel-js: https://github.com/corbel-platform/corbel-js\n * Original module: https://github.com/corbel-platform/corbel-js/blob/master/src/jwt.js\n */\n// jscs:disable requireCamelCaseOrUpperCaseIdentifiers\n// TODO: Use ES6 syntax\nconst EXPIRATION = 3500;\nconst ALGORITHM = 'HS256';\nconst TYP = 'JWT';\nconst VERSION = '1.0.0';\n\n/**\n * JWT-HmacSHA256 generator\n * http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html\n *\n * @param  {Object}                                 claims Specific claims to include in the JWT (iss, aud, exp, scope, ...)\n * @param  {String} secret                          String with the client assigned secret\n * @param  {Object} [alg='corbel.jwt.ALGORITHM']    Object with the algorithm type\n * @return {String} jwt                             JWT string\n */\nexport function generate(claims, secret, alg) {\n  claims = claims || {};\n  claims.exp = claims.exp || _generateExp();\n\n  if (!claims.iss) {\n    throw new Error('jwt:undefined:iss');\n  }\n  if (!claims.aud) {\n    throw new Error('jwt:undefined:aud');\n  }\n\n  return _generate(claims, secret, alg);\n}\n\nexport function decode(assertion) {\n  var decoded = assertion.split('.');\n\n  try {\n    decoded[0] = JSON.parse(atob(decoded[0]));\n  } catch (e) {\n    decoded[0] = false;\n  }\n\n  try {\n    decoded[1] = JSON.parse(atob(decoded[1]));\n  } catch (e) {\n    decoded[1] = false;\n  }\n\n  if (!decoded[0] && !decoded[1]) {\n    throw new Error('corbel:jwt:decode:invalid_assertion');\n  }\n\n  decoded[0] = decoded[0] || {};\n  decoded[1] = decoded[1] || {};\n\n  Object.keys(decoded[1]).forEach(function(key) {\n    decoded[0][key] = decoded[1][key];\n  });\n\n  return decoded[0];\n}\n\nfunction _generate(claims, secret, alg) {\n  alg = alg || ALGORITHM;\n\n  // Ensure claims specific order\n  var claimsKeys = [\n    'iss',\n    'aud',\n    'exp',\n    'scope',\n    'prn',\n    'version',\n    'refresh_token',\n    'request_domain',\n\n    'basic_auth.username',\n    'basic_auth.password',\n\n    'device_id'\n  ];\n\n  var finalClaims = {};\n  claimsKeys.forEach(function(key) {\n    if (claims[key]) {\n      finalClaims[key] = claims[key];\n    }\n  });\n\n  Object.assign(finalClaims, claims);\n\n  if (Array.isArray(finalClaims.scope)) {\n    finalClaims.scope = finalClaims.scope.join(' ');\n  }\n\n  var bAlg = cryptography.rstr2b64(cryptography.str2rstr_utf8(JSON.stringify({\n      typ: TYP,\n      alg: alg\n    })));\n  var bClaims = cryptography.rstr2b64(cryptography.str2rstr_utf8(JSON.stringify(finalClaims)));\n  var segment = bAlg + '.' + bClaims;\n  var assertion = cryptography.b64tob64u(cryptography.b64_hmac_sha256(secret, segment));\n\n  return segment + '.' + assertion;\n}\n\nfunction _generateExp() {\n  return Math.round((new Date().getTime() / 1000)) + EXPIRATION;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/jwt.js\n **/","/*************************************************************************************************\n * Extracted from Corbel-js: https://github.com/corbel-platform/corbel-js                        *\n * Original module: https://github.com/corbel-platform/corbel-js/blob/master/src/cryptography.js *\n *************************************************************************************************/\n\n/*********************************************************************************\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined *\n * in FIPS 180-2                                                                 *\n * Version 2.2 Copyright Angel Marin, Paul Johnston 2000 - 2009.                 *\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet                 *\n * Distributed under the BSD License                                             *\n * See http://pajhome.org.uk/crypt/md5 for details.                              *\n * Also http://anmar.eu.org/projects/jssha2/                                     *\n *********************************************************************************/\n// TODO: Use ES6 syntax\n/*\n * Configurable variables. You may need to tweak these to be compatible with\n * the server-side, but the defaults work in most cases.\n */\nlet hexcase = 0; /* hex output format. 0 - lowercase; 1 - uppercase        */\nlet b64pad = ''; /* base-64 pad character. \"=\" for strict RFC compliance   */\n\n/* jshint ignore:start */\n// jscs:disable\nlet sha256_K = new Array(\n  1116352408, 1899447441, -1245643825, -373957723, 961987163, 1508970993, -1841331548, -1424204075, -670586216, 310598401, 607225278, 1426881987,\n  1925078388, -2132889090, -1680079193, -1046744716, -459576895, -272742522,\n  264347078, 604807628, 770255983, 1249150122, 1555081692, 1996064986, -1740746414, -1473132947, -1341970488, -1084653625, -958395405, -710438585,\n  113926993, 338241895, 666307205, 773529912, 1294757372, 1396182291,\n  1695183700, 1986661051, -2117940946, -1838011259, -1564481375, -1474664885, -1035236496, -949202525, -778901479, -694614492, -200395387, 275423344,\n  430227734, 506948616, 659060556, 883997877, 958139571, 1322822218,\n  1537002063, 1747873779, 1955562222, 2024104815, -2067236844, -1933114872, -1866530822, -1538233109, -1090935817, -965641998\n);\n\nexport function b64_hmac_sha256(k, d) {\n  return rstr2b64(rstr_hmac_sha256(str2rstr_utf8(k), str2rstr_utf8(d)));\n};\n\n/*\n * Calculate the HMAC-sha256 of a key and some data (raw strings)\n */\nexport function rstr_hmac_sha256(key, data) {\n  var bkey = rstr2binb(key);\n  if (bkey.length > 16) {\n    bkey = binb_sha256(bkey, key.length * 8);\n  }\n\n  var ipad = Array(16),\n    opad = Array(16);\n  for (var i = 0; i < 16; i++) {\n    ipad[i] = bkey[i] ^ 0x36363636;\n    opad[i] = bkey[i] ^ 0x5C5C5C5C;\n  }\n\n  var hash = binb_sha256(ipad.concat(rstr2binb(data)), 512 + data.length * 8);\n  return binb2rstr(binb_sha256(opad.concat(hash), 512 + 256));\n};\n\n/*\n * Convert a raw string to a base-64 string\n */\nexport function rstr2b64(input) {\n  try {\n    b64pad\n  } catch (e) {\n    b64pad = '';\n  }\n  var tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n  var output = '';\n  var len = input.length;\n  for (var i = 0; i < len; i += 3) {\n    var triplet = (input.charCodeAt(i) << 16) | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0) | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\n    for (var j = 0; j < 4; j++) {\n      if (i * 8 + j * 6 > input.length * 8) output += b64pad;\n      else output += tab.charAt((triplet >>> 6 * (3 - j)) & 0x3F);\n    }\n  }\n  return output;\n};\n\n/*\n * Encode a string as utf-8.\n * For efficiency, this assumes the input is valid utf-16.\n */\nexport function str2rstr_utf8(input) {\n  var output = '';\n  var i = -1;\n  var x, y;\n\n  while (++i < input.length) {\n    /* Decode utf-16 surrogate pairs */\n    x = input.charCodeAt(i);\n    y = i + 1 < input.length ? input.charCodeAt(i + 1) : 0;\n    if (0xD800 <= x && x <= 0xDBFF && 0xDC00 <= y && y <= 0xDFFF) {\n      x = 0x10000 + ((x & 0x03FF) << 10) + (y & 0x03FF);\n      i++;\n    }\n\n    /* Encode output as utf-8 */\n    if (x <= 0x7F)\n      output += String.fromCharCode(x);\n    else if (x <= 0x7FF)\n      output += String.fromCharCode(0xC0 | ((x >>> 6) & 0x1F),\n        0x80 | (x & 0x3F));\n    else if (x <= 0xFFFF)\n      output += String.fromCharCode(0xE0 | ((x >>> 12) & 0x0F),\n        0x80 | ((x >>> 6) & 0x3F),\n        0x80 | (x & 0x3F));\n    else if (x <= 0x1FFFFF)\n      output += String.fromCharCode(0xF0 | ((x >>> 18) & 0x07),\n        0x80 | ((x >>> 12) & 0x3F),\n        0x80 | ((x >>> 6) & 0x3F),\n        0x80 | (x & 0x3F));\n  }\n  return output;\n};\n\n/*\n * Convert a raw string to an array of big-endian words\n * Characters >255 have their high-byte silently ignored.\n */\nexport function rstr2binb(input) {\n  var output = Array(input.length >> 2);\n  for (var i = 0; i < output.length; i++)\n    output[i] = 0;\n  for (var i = 0; i < input.length * 8; i += 8)\n    output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (24 - i % 32);\n  return output;\n};\n\n/*\n * Convert an array of big-endian words to a string\n */\nexport function binb2rstr(input) {\n  var output = '';\n  for (var i = 0; i < input.length * 32; i += 8)\n    output += String.fromCharCode((input[i >> 5] >>> (24 - i % 32)) & 0xFF);\n  return output;\n};\n\n/*\n * Main sha256 function, with its support functions\n */\nexport function sha256_S(X, n) {\n  return (X >>> n) | (X << (32 - n));\n};\n\nexport function sha256_R(X, n) {\n  return (X >>> n);\n};\n\nexport function sha256_Ch(x, y, z) {\n  return ((x & y) ^ ((~x) & z));\n};\n\nfunction sha256_Maj(x, y, z) {\n  return ((x & y) ^ (x & z) ^ (y & z));\n};\n\nexport function sha256_Sigma0256(x) {\n  return (sha256_S(x, 2) ^ sha256_S(x, 13) ^ sha256_S(x, 22));\n};\n\nexport function sha256_Sigma1256(x) {\n  return (sha256_S(x, 6) ^ sha256_S(x, 11) ^ sha256_S(x, 25));\n};\n\nexport function sha256_Gamma0256(x) {\n  return (sha256_S(x, 7) ^ sha256_S(x, 18) ^ sha256_R(x, 3));\n};\n\nexport function sha256_Gamma1256(x) {\n  return (sha256_S(x, 17) ^ sha256_S(x, 19) ^ sha256_R(x, 10));\n};\n\nexport function binb_sha256(m, l) {\n  var HASH = new Array(1779033703, -1150833019, 1013904242, -1521486534,\n    1359893119, -1694144372, 528734635, 1541459225);\n  var W = new Array(64);\n  var a, b, c, d, e, f, g, h;\n  var i, j, T1, T2;\n\n  /* append padding */\n  m[l >> 5] |= 0x80 << (24 - l % 32);\n  m[((l + 64 >> 9) << 4) + 15] = l;\n\n  for (i = 0; i < m.length; i += 16) {\n    a = HASH[0];\n    b = HASH[1];\n    c = HASH[2];\n    d = HASH[3];\n    e = HASH[4];\n    f = HASH[5];\n    g = HASH[6];\n    h = HASH[7];\n\n    for (j = 0; j < 64; j++) {\n      if (j < 16) W[j] = m[j + i];\n      else W[j] = safe_add(safe_add(safe_add(sha256_Gamma1256(W[j - 2]), W[j - 7]),\n        sha256_Gamma0256(W[j - 15])), W[j - 16]);\n\n      T1 = safe_add(safe_add(safe_add(safe_add(h, sha256_Sigma1256(e)), sha256_Ch(e, f, g)),\n        sha256_K[j]), W[j]);\n      T2 = safe_add(sha256_Sigma0256(a), sha256_Maj(a, b, c));\n      h = g;\n      g = f;\n      f = e;\n      e = safe_add(d, T1);\n      d = c;\n      c = b;\n      b = a;\n      a = safe_add(T1, T2);\n    }\n\n    HASH[0] = safe_add(a, HASH[0]);\n    HASH[1] = safe_add(b, HASH[1]);\n    HASH[2] = safe_add(c, HASH[2]);\n    HASH[3] = safe_add(d, HASH[3]);\n    HASH[4] = safe_add(e, HASH[4]);\n    HASH[5] = safe_add(f, HASH[5]);\n    HASH[6] = safe_add(g, HASH[6]);\n    HASH[7] = safe_add(h, HASH[7]);\n  }\n  return HASH;\n};\n\nexport function safe_add(x, y) {\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return (msw << 16) | (lsw & 0xFFFF);\n};\n\n/*! base64x-1.1.3 (c) 2012-2014 Kenji Urushima | kjur.github.com/jsjws/license\n */\n/*\n * base64x.js - Base64url and supplementary functions for Tom Wu's base64.js library\n *\n * version: 1.1.3 (2014 May 25)\n *\n * Copyright (c) 2012-2014 Kenji Urushima (kenji.urushima@gmail.com)\n *\n * This software is licensed under the terms of the MIT License.\n * http://kjur.github.com/jsjws/license/\n *\n * The above copyright and license notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * DEPENDS ON:\n *   - base64.js - Tom Wu's Base64 library\n */\n\n/**\n * Base64URL and supplementary functions for Tom Wu's base64.js library.<br/>\n * This class is just provide information about global functions\n * defined in 'base64x.js'. The 'base64x.js' script file provides\n * global functions for converting following data each other.\n * <ul>\n * <li>(ASCII) String</li>\n * <li>UTF8 String including CJK, Latin and other characters</li>\n * <li>byte array</li>\n * <li>hexadecimal encoded String</li>\n * <li>Full URIComponent encoded String (such like \"%69%94\")</li>\n * <li>Base64 encoded String</li>\n * <li>Base64URL encoded String</li>\n * </ul>\n * All functions in 'base64x.js' are defined in {@link _global_} and not\n * in this class.\n * Base64URL and supplementary functions for Tom Wu's base64.js library\n *\n * @class\n * @author Kenji Urushima\n * @version 1.1 (07 May 2012)\n * @requires base64.js\n * @see <a href=\"http://kjur.github.com/jsjws/\">'jwjws'(JWS JavaScript Library) home page http://kjur.github.com/jsjws/</a>\n * @see <a href=\"http://kjur.github.com/jsrsasigns/\">'jwrsasign'(RSA Sign JavaScript Library) home page http://kjur.github.com/jsrsasign/</a>\n */\nexport function Base64x() {};\n\n// ==== base64 / base64url ================================\n/**\n * convert a Base64 encoded string to a Base64URL encoded string.<br/>\n * Example: \"ab+c3f/==\" &rarr; \"ab-c3f_\"\n *\n * @param {String} s Base64 encoded string\n * @return {String} Base64URL encoded string\n */\nexport function b64tob64u(s) {\n  s = s.replace(/\\=/g, '');\n  s = s.replace(/\\+/g, '-');\n  s = s.replace(/\\//g, '_');\n  return s;\n};\n/* jshint ignore:end */\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/cryptography.js\n **/","import * as utils from '../utils/utils';\n\nif (this && this.Meteor) {\n  // NOTE: this only work if it is used with the meteor package version of this library.\n\n  this.Headers = fetch.Headers,\n  this.Request = fetch.Request;\n\n  fetch.Promise = Promise;\n}\n\nclass AuthRequest {\n  constructor(authConfig) {\n    // Init auth variables\n    this.authConfig = authConfig;\n  }\n\n  /////////////////\n  // Private API //\n  /////////////////\n\n  /**\n   * Creates a credentials object with data stored in this.authconfig\n   * and extends it with more authData (if provided)\n   *\n   * @param  {Object} authData Extended auth data (i.e. user & pass)\n   * @param  {String} scope\n   * @return {Object}\n   */\n  _createClaims(authData, scope) {\n    const { clientId, iamAUD, scopes, defaultAuthData } = this.authConfig;\n    let claims = {\n      iss: clientId,\n      aud: iamAUD,\n      scope: scopes[scope]\n    };\n\n    Object.assign(claims, defaultAuthData);\n    Object.assign(claims, authData);\n\n    return claims;\n  }\n\n  /**\n   * Generates jwt\n   *\n   * @param  {Object} claims\n   * @param  {String} clientSecret\n   * @return {String}\n   */\n  _generateAssertion(claims, clientSecret) {\n    return utils.jwt.generate(claims, clientSecret);\n  }\n\n  /**\n   * Authenticates with composr\n   * Uses fetch (or fetch polyfill: https://github.com/github/fetch)\n   *\n   * @param  {String} endpoint     Endpoint to comunicate with\n   * @param  {Object} claims  Credentials data created with _createClaims\n   * @param  {Object} headers\n   * @return {Object} A result promise\n   */\n  _authenticate(endpoint, claims, headers) {\n    const { endpoints, urlBase, clientSecret, defaultHeaders } = this.authConfig;\n    const url = utils.buildURI(urlBase) + endpoints[endpoint];\n    const jwt = this._generateAssertion(claims, clientSecret);\n    const body = {\n      jwt\n    };\n    let authenticationHeaders = {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json; charset=utf-8'\n    };\n\n    Object.assign(authenticationHeaders, defaultHeaders);\n    Object.assign(authenticationHeaders, headers);\n\n    let headersInstance = new Headers(authenticationHeaders);\n\n    const request = new Request(url, {\n      credentials: 'include',\n      mode: 'cors',\n      cache: 'no-store',\n      method: 'POST',\n      headers: headersInstance,\n      body: JSON.stringify(body)\n    });\n\n    return fetch(request).then(utils.checkStatus);\n  }\n\n  ////////////////\n  // Public API //\n  ////////////////\n\n  /**\n   * Authenticates with client scope\n   *\n   * @return {Object} Promise\n   */\n  authenticateClient() {\n    const claims = this._createClaims({}, 'client');\n\n    this.clientAccessTokenPromise = this._authenticate('loginClient', claims);\n\n    return this.clientAccessTokenPromise;\n  }\n\n  /**\n   * Sign in method\n   * Calls _authenticate() method with the inserted credentials\n   *\n   * @return {Object} A result promise\n   */\n  authenticateUser({email, password, headersExtension = {}, authDataExtension = {}}) {\n    const authData = Object.assign({\n      'basic_auth.username': email,\n      'basic_auth.password': password\n    }, authDataExtension);\n\n    const claims = this._createClaims(authData, 'user');\n\n    const request = this._authenticate('login', claims, headersExtension);\n\n    return request;\n  }\n\n  /**\n   * Refresh Token method\n   * Calls _authenticate() method with the user refresh token provided\n   *\n   * @return {Object} A result promise\n   */\n  refreshUserToken({refreshToken, headersExtension = {}, authDataExtension = {}}) {\n    const authData = Object.assign({\n      'refresh_token': refreshToken\n    }, authDataExtension);\n\n    const claims = this._createClaims(authData, 'user');\n\n    const request = this._authenticate('refreshToken', claims, headersExtension);\n\n    return request;\n  }\n\n  /**\n   * Logs out method\n   * Calls _authenticate() method with provided credentials\n   */\n  logoutUser({accessToken, headersExtension = {}, authDataExtension = {}}) {\n    const headers = Object.assign({\n      'Authorization': accessToken,\n    }, headersExtension);\n\n    const claims = this._createClaims(authDataExtension, 'user');\n\n    const request = this._authenticate('logout', claims, headers);\n\n    return request;\n  }\n}\n\nexport default AuthRequest;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/auth/AuthRequest.js\n **/","class AuthPersist {\n  constructor(cookies = []) {\n    this._isNode();\n    this.getRememberFromStorage();\n    this.getTokensFromStorage();\n    this.cookies = cookies;\n  }\n\n  /////////////////\n  // Private API //\n  /////////////////\n\n  _isNode() {\n    const evaluateEnvironment = new Function('try {return window;}catch(e){ return false;}');\n\n    if (evaluateEnvironment()) {\n      this.sessionStorage = window.sessionStorage;\n      this.localStorage = window.localStorage;\n\n      return false;\n    }\n\n    this.sessionStorage = {\n      removeItem(item) {\n        this[item] = void 0;\n      }\n    };\n\n    this.localStorage = {\n      removeItem(item) {\n        this[item] = void 0;\n      }\n    };\n\n    return true;\n  }\n\n  /**\n   * Adds data to localStorage\n   *\n   * @param {Object} data\n   */\n  _addLocalStorage(data) {\n    if (this.remember) {\n      this.localStorage.remember = true;\n      this.localStorage.refreshToken = data.refreshToken;\n    }\n    if (data.authOptions) {\n      this.localStorage.authOptions = JSON.stringify(data.authOptions);\n    }\n    this.localStorage.scopes = data.scopes;\n    this.localStorage.accessToken = data.accessToken;\n    this.localStorage.expiresAt = data.expiresAt;\n\n  }\n\n  /**\n   * Adds data to sessionStorage\n   *\n   * @param {Object} data\n   */\n  _addSessionStorage(data) {\n\n    if (this.remember) {\n      this.sessionStorage.remember = true;\n    }\n    if (data.authOptions) {\n      this.sessionStorage.authOptions = JSON.stringify(data.authOptions);\n    }\n    this.sessionStorage.scopes = data.scopes;\n    this.sessionStorage.refreshToken = data.refreshToken;\n    this.sessionStorage.accessToken = data.accessToken;\n    this.sessionStorage.expiresAt = data.expiresAt;\n\n  }\n\n  /**\n   * Removes auth data from localStorage\n   */\n  _removeLocalStorage() {\n    var items = ['refreshToken', 'accessToken', 'expiresAt', 'scopes', 'remember', 'authOptions'];\n\n    for (let i in items) {\n      this.localStorage.removeItem(items[i]);\n    }\n  }\n\n  /**\n   * Removes auth data from sessionStorage\n   */\n  _removeSessionStorage() {\n    var items = ['refreshToken', 'accessToken', 'expiresAt', 'scopes', 'remember', 'authOptions'];\n\n    for (let i in items) {\n      this.sessionStorage.removeItem(items[i]);\n    }\n  }\n\n  _removeUserCookie(cookieName) {\n    document.cookie = cookieName + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n  }\n\n  _removeUserCookies() {\n    // TODO: Due to an issue with ios 8 or lower versions\n    //  it's better to use for..in loops instead for..of\n    //\n    // Replace following lines in projects without support for this browsers:\n    //\n    // for (const cookie of this.cookies) {\n    //   this._removeUserCookie(cookie);\n    // }\n    for (let i in this.cookies) {\n      const cookie = this.cookies[i];\n      this._removeUserCookie(cookie);\n    }\n  }\n\n  _getAuthOptionsFromStorage() {\n    let authOptions = this.sessionStorage.authOptions ||\n      this.localStorage.authOptions;\n    try {\n      authOptions = JSON.parse(authOptions);\n    } catch (err) {\n      authOptions = {};\n    }\n    return authOptions;\n  }\n\n  _getUserAccessToken() {\n    const sessionStorageToken = {\n      accessToken: this.sessionStorage.accessToken,\n      expiresAt: parseInt(this.sessionStorage.expiresAt)\n    };\n\n    const localStorageToken = {\n      accessToken: this.localStorage.accessToken,\n      expiresAt: parseInt(this.localStorage.expiresAt)\n    };\n\n    let mostRecentToken = {};\n\n    if (!isNaN(sessionStorageToken.expiresAt) && !isNaN(localStorageToken.expiresAt)) {\n      mostRecentToken = sessionStorageToken.expiresAt > localStorageToken.expiresAt ? sessionStorageToken : localStorageToken;\n      return mostRecentToken;\n    }\n\n    mostRecentToken = isNaN(sessionStorageToken.expiresAt) ? localStorageToken : sessionStorageToken;\n\n    return mostRecentToken;\n  }\n\n  _getUserTokens() {\n    const refreshToken = this.sessionStorage.refreshToken ||\n      this.localStorage.refreshToken;\n    const scopes = this.sessionStorage.scopes ||\n      this.localStorage.scopes;\n    const {\n      accessToken,\n      expiresAt\n    } = this._getUserAccessToken();\n    const userTokens = {\n      refreshToken,\n      accessToken,\n      expiresAt,\n      scopes\n    };\n\n    return userTokens;\n  }\n\n  _getClientAccessToken() {\n    let accessToken = this.sessionStorage.clientAccessToken;;\n    let expiresAt = this.sessionStorage.clientExpiresAt;\n\n    return {\n      accessToken,\n      expiresAt\n    };\n  }\n\n  ////////////////\n  // Public API //\n  ////////////////\n\n  /**\n   * Persist client accessToken\n   */\n  persistClientToken({\n    accessToken,\n    expiresAt\n  }) {\n\n    this.sessionStorage.clientAccessToken = accessToken;\n    this.sessionStorage.clientExpiresAt = expiresAt;\n\n    this.tokens.client = {\n      accessToken,\n      expiresAt\n    };\n  }\n\n  /**\n   * Stores result auth data in local & session storage\n   *\n   * @param  {Object} tokenObject [accessToken, refreshToken, expiresAt, authOptions]\n   */\n  persistAuthData(tokenObject) {\n    const {\n      accessToken,\n      refreshToken,\n      expiresAt,\n      scopes,\n      authOptions\n    } = tokenObject;\n\n    if (this.remember) {\n      this._addLocalStorage(tokenObject);\n      this._addSessionStorage(tokenObject);\n\n    } else {\n      // Not saving in localstorage if user doesnt check remember option\n      // When browser is closed, user is logged out\n      this._addSessionStorage(tokenObject);\n    }\n\n    this.tokens.user = {\n      accessToken,\n      refreshToken,\n      expiresAt,\n      scopes\n    };\n\n    this.tokens.authOptions = authOptions;\n\n    return true;\n  }\n\n  removeAllUserData() {\n    this._removeLocalStorage();\n    this._removeSessionStorage();\n    this._removeUserCookies();\n  }\n\n  getRememberFromStorage() {\n    const remember = this.sessionStorage.remember ||\n      this.localStorage.remember;\n\n    this.remember = (remember === 'true');\n\n    return this.remember;\n  }\n\n  getTokensFromStorage() {\n    let tokens = {\n      client: this._getClientAccessToken(),\n      user: this._getUserTokens(),\n      authOptions: this._getAuthOptionsFromStorage()\n    };\n    this.tokens = tokens;\n\n    return tokens;\n  }\n}\n\nexport default AuthPersist;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/auth/AuthPersist.js\n **/","import AuthRequest from './AuthRequest';\nimport AuthPersist from './AuthPersist';\nimport * as utils from '../utils/utils';\n\nclass AuthConnector {\n  constructor({options = {}, authConfig, authPersist = new AuthPersist(), authRequest = new AuthRequest(authConfig)}) {\n    this.authPersist = authPersist;\n    this.authRequest = authRequest;\n    this.options = options;\n    this.userAuthenticated = false;\n  }\n\n  /////////////////\n  // Private API //\n  /////////////////\n\n  /**\n   * Set authentication status and dispatch an event\n   */\n  _setAuthentication(auth) {\n    utils.events.publish('userAuthenticated', auth);\n    this.userAuthenticated = auth;\n  }\n\n  /**\n   * Validates accesstoken and refresh if it's necessary\n   */\n  _validateAccessToken() {\n    this.authPersist.getTokensFromStorage();\n    const {accessToken, expiresAt, refreshToken} = this.authPersist.tokens.user;\n    const validAccessToken = accessToken && expiresAt && (Date.now() < expiresAt);\n    let accessTokenPromise;\n\n    if (validAccessToken) {\n      // Accesstoken exists and is not expired\n      accessTokenPromise = Promise.resolve({\n        accessToken\n      });\n    } else if (refreshToken) {\n      // AccessToken expired or missed: refresh token if exists\n      accessTokenPromise = this.refreshUserToken();\n    } else {\n      accessTokenPromise = Promise.reject('No accessToken or refreshToken');\n    }\n\n    return accessTokenPromise;\n  }\n\n  /**\n   * Validates if clientAccessToken exists in sessionStorage and is not expired\n   *\n   * @return {String} clientAccessToken\n   */\n  _validateClientAccessToken(clientToken) {\n\n    const isValid = (clientToken &&\n      clientToken.accessToken &&\n      clientToken.expiresAt &&\n      Date.now() < parseInt(clientToken.expiresAt));\n\n    return isValid ? clientToken : false;\n\n  }\n\n  /**\n   * Parse token object when comes inside another object\n   *\n   * @param  {Object} response Request response object\n   * @return {Object}          Token object\n   */\n  _parseTokenObject(response) {\n    if (response.tokenObject) {\n      return response.tokenObject;\n    }\n\n    return response;\n  }\n\n  /**\n   * Execute optional callbacks\n   *\n   * @param  {String} name    Name of the event\n   * @param  {Object} promise Unresolved event promise\n   */\n  _executePromiseCb(name, promise) {\n\n    this._publishEvent(name, promise);\n\n    if (!this.options.callbacks) {\n      return;\n    }\n\n    let successCb;\n    let errorCb;\n\n    if (this.options.callbacks.success) {\n      successCb = this.options.callbacks.success[name];\n    }\n\n    if (this.options.callbacks.error) {\n      errorCb = this.options.callbacks.error[name];\n    }\n\n    promise\n    .then(successCb)\n    .catch(errorCb);\n  }\n\n  /**\n   * Publish events when promises are resolved (use it instead callbacks)\n   *\n   * @param  {String} name  Name of the event\n   * @param  {Object} promise Unresolved event promise\n   */\n  _publishEvent(name, promise) {\n    promise\n    .then((res) => {\n      utils.events.publish(name, {\n        result: 'success',\n        response: res\n      });\n    })\n    .catch((err) => {\n      utils.events.publish(name, {\n        result: 'error',\n        response: err\n      });\n    });\n  }\n\n  ////////////////\n  // Public API //\n  ////////////////\n\n  /**\n   * Init method\n   * Make a client login and use authValidation method\n   * to check if exists a previous valid session\n   */\n  init() {\n    this.loginClient();\n    this.authValidation()\n      .then(() => this._setAuthentication(true))\n      .catch(() => this._setAuthentication(false));\n  }\n\n  /**\n   * Checks if exists a valid user session\n   *\n   * @return {Object} Promise\n   */\n  authValidation() {\n    var that = this;\n    // Use a previous authValidation promise if it is already pending\n    if (this.validationPromise && this._validationState === 'Pending') {\n      return this.validationPromise;\n    }\n\n    this._validationState = 'Pending';\n\n    const validationRequest = this._validateAccessToken();\n\n    validationRequest\n      .then(() => this._validationState = 'Resolved')\n      .catch(() => this._validationState = 'Resolved');\n\n    this.validationPromise = validationRequest;\n\n    return validationRequest;\n  }\n\n  /**\n  * Dispatch user accessToken if it's available, if not, dispatch client accessToken\n  *\n  * @return {Object} Promise\n  */\n  getCurrentToken() {\n    this.authPersist.getTokensFromStorage();\n\n    const currentTokenPromise = this.authValidation()\n    .then(() => {\n      const accessToken = this.authPersist.tokens.user.accessToken;\n      if (accessToken && this.userAuthenticated === false) {\n        this._setAuthentication(true);\n      }\n      return accessToken;\n    })\n    .catch(() => {\n      return this.loginClient()\n      .then(this._parseTokenObject)\n      .then(res => res.accessToken);\n    });\n\n    return currentTokenPromise;\n  }\n\n  /**\n   * Authenticates with client scope\n   *\n   * @return {Object} Promise\n   */\n  loginClient() {\n    this.authPersist.getTokensFromStorage();\n    const storedClientToken = this.authPersist.tokens.client;\n    const currentClientAccessToken = this._validateClientAccessToken(storedClientToken);\n\n    // Resolve current clientToken if exists\n    if (currentClientAccessToken) {\n      return Promise.resolve(currentClientAccessToken);\n    }\n\n    // Ask for a new clientToken\n    const clientAccessTokenPromise = this.authRequest.authenticateClient()\n    .then(this._parseTokenObject)\n    .then(res => {\n      this.authPersist.persistClientToken(res);\n      return res;\n    });\n\n    this._executePromiseCb('loginClient', clientAccessTokenPromise);\n    this.clientAccessTokenPromise = clientAccessTokenPromise;\n\n    return clientAccessTokenPromise;\n  }\n\n  /**\n   * Sign in method\n   *\n   * @return {Object} A result promise\n   */\n  loginUser({email, password, remember}) {\n    const {authDataExtension = {}, headersExtension = {}} = this.options;\n\n    const request = this.authRequest.authenticateUser({\n      email,\n      password,\n      remember,\n      headersExtension,\n      authDataExtension\n    })\n    .then(this._parseTokenObject)\n    .then(res => {\n      res.authOptions = this.options;\n      this.authPersist.remember = remember ? remember : false;\n      this.authPersist.persistAuthData(res);\n      this._setAuthentication(true);\n\n      return res;\n    });\n\n    this._executePromiseCb('loginUser', request);\n    this.loginUserPromise = request;\n\n    return request;\n  }\n\n  /**\n   * Refresh token method\n   *\n   * @return {Object}  A result promise\n   */\n  refreshUserToken() {\n    this.authPersist.getTokensFromStorage();\n\n    const refreshToken = this.authPersist.tokens.user.refreshToken;\n    const {authDataExtension = {}, headersExtension = {}} = this.authPersist.tokens.authOptions;\n\n    const request = this.authRequest.refreshUserToken({\n      refreshToken,\n      headersExtension,\n      authDataExtension\n    })\n    .then(this._parseTokenObject)\n    .then(res => {\n      this.authPersist.persistAuthData(res);\n      this._setAuthentication(true);\n\n      return res;\n    });\n\n    this._executePromiseCb('refreshUserToken', request);\n    this.refreshUserTokenPromise = request;\n\n    return request;\n  }\n\n  /**\n   * Logout method\n   * Calls _authenticate() method\n   */\n  logoutUser() {\n    this.authPersist.getTokensFromStorage();\n\n    const accessToken = this.authPersist.tokens.user.accessToken;\n    const {authDataExtension = {}, headersExtension = {}} = this.authPersist.tokens.authOptions;\n\n    const request = this.authRequest.logoutUser({\n      accessToken,\n      headersExtension,\n      authDataExtension\n    });\n\n    this._setAuthentication(false);\n    this.authPersist.removeAllUserData();\n    this._executePromiseCb('logoutUser', request);\n\n    return request;\n  }\n}\n\nexport default AuthConnector;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/auth/AuthConnector.js\n **/","import AuthConnector from '../auth/AuthConnector';\nimport * as utils from '../utils/utils';\n\nif (this && this.Meteor) {\n  // NOTE: this only work if it is used with the meteor package version of this library.\n\n  this.Headers = fetch.Headers;\n  this.Request = fetch.Request;\n\n  fetch.Promise = Promise;\n}\n\nclass Connect {\n  constructor({config, options = {}, authConnector = new AuthConnector({\n        authConfig: config\n      })}) {\n    this.authConnector = authConnector;\n    this.endpoints = config.endpoints;\n    this.urlBase = config.urlBase;\n    this.options = options;\n\n    this._requestDataQueue = [];\n\n    this.authConnector.init();\n  }\n\n  /////////////////\n  // Private API //\n  /////////////////\n\n  _buildHeaders({token, headersExtension}) {\n    const defaultHeaders = {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json; charset=utf-8',\n      'Authorization': 'Bearer ' + token\n    };\n\n    let headers = Object.assign(defaultHeaders, this.options.headersExtension, headersExtension);\n\n    return new Headers(headers);\n  }\n\n  _buildRequestParams({body, queryParams}) {\n    const queryPath = this._buildQueryPath(queryParams);\n\n    if (body) {\n      body = JSON.stringify(body);\n    }\n\n    return {\n      body,\n      queryPath\n    };\n  }\n\n  _buildQueryPath(dict) {\n    var query = '';\n    if (dict) {\n      var queries = [];\n      Object.keys(dict).forEach(function(key) {\n        queries.push(key + '=' + dict[key]);\n      });\n      if (queries.length > 0) {\n        query = '?' + queries.join('&');\n      }\n    }\n    return query;\n  }\n\n  _buildUrl({endpoint, queryPath}) {\n    let requestEndpoint = this.endpoints[endpoint];\n\n    if (endpoint.key) {\n      requestEndpoint = this.endpoints[endpoint.key] + endpoint.id;\n    }\n\n    const url = utils.buildURI(this.urlBase) + requestEndpoint + queryPath;\n\n    return url;\n  }\n\n  _buildRequest({endpoint, method, params, data, headersExtension} , token) {\n    const {body, queryPath} = this._buildRequestParams({\n      queryParams: params,\n      body: data\n    });\n    const url = this._buildUrl({\n      endpoint,\n      queryPath\n    });\n    const headers = this._buildHeaders({\n      token,\n      headersExtension\n    });\n\n    const request = new Request(url, {\n      credentials: 'include',\n      mode: 'cors',\n      cache: 'no-store',\n      method,\n      headers,\n      body\n    });\n\n    return fetch(request)\n      .then(utils.checkStatus);\n  }\n\n  _createRetryRequests(tokenObject) {\n    const { accessToken } = tokenObject;\n    let requestDataQueue;\n    let requestsCallback;\n    let retryRequests = [];\n\n    if (this.options.retryRequestProxy) {\n      const retryRequestProxyResponse = this.options.retryRequestProxy(tokenObject, this._requestDataQueue);\n      requestDataQueue = retryRequestProxyResponse.requestDataQueue;\n      requestsCallback = retryRequestProxyResponse.requestsCallback;\n    } else {\n      requestDataQueue = this._requestDataQueue;\n      requestsCallback = (data) => data;\n    }\n\n    // TODO: Due to an issue with ios 8 or lower versions\n    //  it's better to use for..in loops instead for..of\n    //\n    // Replace following lines in projects without support for this browsers:\n    //\n    // for (const data of requestDataQueue) {\n    //   const request = this._buildRequest(data, accessToken);\n    //\n    //   retryRequests.push(request);\n    // }\n    for (let i in requestDataQueue) {\n      const data = requestDataQueue[i];\n      const request = this._buildRequest(data, accessToken);\n\n      retryRequests.push(request);\n    }\n\n    this._requestDataQueue = [];\n\n    return Promise.all(retryRequests)\n      .then(requestsCallback);\n  }\n\n  _retry(requestData) {\n    this._requestDataQueue.push(requestData);\n\n    if (this._retryStatus === 'Pending') {\n      return this._retryRequest;\n    }\n\n    this._retryStatus = 'Pending';\n\n    const refreshTokenPromise = this.authConnector.refreshUserToken();\n    this._retryRequest = refreshTokenPromise\n      .then((tokenObject) => this._createRetryRequests(tokenObject));\n\n    refreshTokenPromise\n      .then(() => this._retryStatus = 'Resolved')\n      .catch(() => this._retryStatus = 'Resolved');\n\n    return this._retryRequest;\n  }\n\n  /**\n   * Send request\n   *\n   * @param  {Object} requestData\n   * @return {Object} Promise\n   */\n  _request(requestData, retry = true) {\n    const fetchRequest = this.authConnector.getCurrentToken()\n      .then((token) => {\n        const request = this._buildRequest(requestData, token);\n\n        return request;\n      })\n      .catch((err) => {\n        if (retry && err.status === 401 && this.authConnector.userAuthenticated) {\n          return this._retry(requestData);\n        }\n\n        throw err;\n      });\n\n    return fetchRequest;\n  }\n\n  ////////////////\n  // Public API //\n  ////////////////\n\n  /**\n   * Send request through proxy\n   *\n   * @param  {Object} requestData\n   * @return {Object} Promise\n   */\n  request(requestData, retry = true) {\n\n    if (this.options.requestProxy) {\n      const requestProxy = this.options.requestProxy;\n      return requestProxy(this._request, requestData, retry);\n    }\n\n    return this._request(requestData, retry);\n  }\n\n  /**\n   * GET request\n   *\n   * @param  {String} endpoint\n   * @param  {Object} params\n   * @return {Object}  Request promise\n   */\n  get(endpoint, params) {\n    const requestData = {\n      method: 'get',\n      endpoint,\n      params\n    };\n\n    return this.request(requestData);\n  }\n\n  /**\n   * DELETE request\n   *\n   * @param  {String} endpoint\n   * @param  {Object} params\n   * @return {Object}  Request promise\n   */\n  delete(endpoint, params) {\n    const requestData = {\n      method: 'delete',\n      endpoint,\n      params\n    };\n\n    return this.request(requestData);\n  }\n\n  /**\n   * POST request\n   *\n   * @param  {String} endpoint\n   * @param  {Object} data\n   * @return {Object}  Request promise\n   */\n  post(endpoint, data) {\n    const requestData = {\n      method: 'post',\n      endpoint,\n      data\n    };\n\n    return this.request(requestData);\n  }\n\n  /**\n   * PUT request\n   *\n   * @param  {String} endpoint\n   * @param  {Object} data\n   * @return {Object}  Request promise\n   */\n  put(endpoint, data) {\n    const requestData = {\n      method: 'put',\n      endpoint,\n      data\n    };\n\n    return this.request(requestData);\n  }\n\n}\n\nexport default Connect;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/connect/Connect.js\n **/"],"sourceRoot":""}